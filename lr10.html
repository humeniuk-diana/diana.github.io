<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Ð›Ð°Ð±Ð¾Ñ€Ð°Ñ‚Ð¾Ñ€Ð½Ð° 10</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body{
  margin:0;
  background: radial-gradient(circle at top left,#ac8764,#63402c);
  color:white;
  display:flex; 
  flex-direction:column; 
  align-items:center; 
  justify-content:center;
  min-height:100vh;;
}
.catGame{
  background:#ffffff0d;
  border-radius:16px;
  padding:20px;
  box-shadow:0 8px 30px rgba(0, 0, 0, 0.5);
  text-align:center;
  max-width: 500px;
}
b{
  margin-left: 15px;
}
.corobka{
  display:flex; 
  justify-content:center; 
  gap:15px;
  margin: 15px;
  flex-wrap: wrap;
}
.dep{
  width:110px; 
  height:350px;
  min-width: 90px;
  background:rgba(255,255,255,0.05);
  border-radius:10px;
  overflow:hidden;
  display:flex; 
  flex-direction:column; 
  justify-content:center; 
  align-items:center;
  border:1px solid #632c2c;
}
.barni{
  height:80px; 
  display:flex; 
  align-items:center; 
  justify-content:center;
  margin-top: 20px;
  margin-bottom: 20px;
}
.barni img{
  width:100px; 
  height:100px; 
  object-fit:contain;
}
.knopka{
  display:flex; 
  justify-content:center; 
  gap:10px;
  flex-wrap: wrap;
}
button {
  background: radial-gradient(circle at top left,#960404,#e4040493);
  color:#fff;
  border:none; 
  padding:10px 18px;
  border-radius:5px; 
  cursor:pointer; 
  font-weight:bold;
  box-shadow:0 4px 10px #ac8764;
}
@keyframes fall {
  0% { transform: translateY(0) rotate(0deg); opacity: 1; }
  100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
}
@media (max-width: 600px) {
  h1 {
    font-size: 25px;
  }
  .dep {
    width: 80px;
    height: auto;
  }
  .barni img {
    width: 110px;
    height: 110px;
  }
  .knopka {
    display: flex;
    gap: 8px;
    justify-content:center; 
  }
  button{
    font-size: 20px;
    padding:10px 25px;
  }
  b{
    font-size: 20px;
  }
}
  </style>
</head>
<body>
  <div class="catGame">

    <h1>Barni game</h1>
    <div>
      <b>Player:</b> <span id="playerName">Cat</span> 
      <b>Spins:</b> <span id="spins">0</span>/3
    </div>
  
    <div class="corobka">
      <div class="dep" id="dep0">
        <div class="barni"><img></div>
        <div class="barni"><img></div>
        <div class="barni"><img></div>
      </div>
      <div class="dep" id="dep1">
        <div class="barni"><img></div>
        <div class="barni"><img></div>
        <div class="barni"><img></div>
      </div>
      <div class="dep" id="dep2">
        <div class="barni"><img></div>
        <div class="barni"><img></div>
        <div class="barni"><img></div>
      </div>
    </div>
  
    <div class="knopka">
      <button id="spin">Spin</button>
      <button id="repeat">Repeat</button>
    </div>
  </div>
  
  <div class="confetti" id="confetti"></div>
<script>
  const dep = [
  document.getElementById('dep0'),
  document.getElementById('dep1'),
  document.getElementById('dep2')
];
const spinBtn = document.getElementById('spin');
const repeatBtn = document.getElementById('repeat');
const spinsText = document.getElementById('spins');
const playerName = document.getElementById('playerName');
const confetti = document.getElementById('confetti');
const img = ["sticker1.webp", "sticker2.webp", "sticker3.webp", "sticker4.webp", "sticker5.webp", "sticker6.webp"];
const max = 3;
let spins = 0;
let won = false;
let winSpin = null;
const userName = prompt("Enter your name:") || "Diana";
playerName.textContent = userName
function randomImg(n) {
  const imgNew = [...img];
  const result = [];
  for (let i = 0; i < n; i++) {
    const index = Math.floor(Math.random() * imgNew.length);
    result.push(imgNew.splice(index, 1)[0]);
  }
  return result;
}
function update(index, images) {
  const imgs = dep[index].querySelectorAll("img");
  imgs.forEach((img, i) => (img.src = images[i]));
}
function animation(index, finalImages) {
  let steps = 15;
  let current = 0;
  const timer = setInterval(() => {
    update(index, randomImg(3));
    current++;
    if (current >= steps) {
      clearInterval(timer);
      update(index, finalImages);
    }
  }, 100);
}
function checkWin(columns) {
  for (let row = 0; row < 3; row++) {
    if (columns[0][row] === columns[1][row] && columns[1][row] === columns[2][row]) {
      return { cells: [[0, row], [1, row], [2, row]] };
    }
  }
  for (let col = 0; col < 3; col++) {
    if (columns[col][0] === columns[col][1] && columns[col][1] === columns[col][2]) {
      return { cells: [[col, 0], [col, 1], [col, 2]] };
    }
  }
  return null;
}
function light(cells) {
  cells.forEach(([col, row]) => {
    const img = dep[col].querySelectorAll("img")[row];
    img.style.backgroundColor = "rgba(255,255,255,0.5)";
    img.style.borderRadius = "10px";
  });
}
function clearlights() {
  dep.forEach(reel => {
    reel.querySelectorAll("img").forEach(img => img.style.backgroundColor = "transparent");
  });
}
function showHearts() {
  for (let i = 0; i < 50; i++) {
    const heart = document.createElement("div");
    heart.textContent = "â¤ï¸";
    heart.style.position = "fixed";
    heart.style.left = Math.random() * 100 + "%";
    heart.style.top = "-10px";
    heart.style.fontSize = (16 + Math.random() * 14) + "px";
    heart.style.animation = `fall ${2 + Math.random() * 3}s linear`;
    confetti.appendChild(heart);
    setTimeout(() => heart.remove(), 4000);
  }
}
function spinAll() {
  if (won) {
    alert(`ðŸŽ‰ You have already won on ${winSpin}th try! Click "Repeat" to play again.`);
    return;
  }
  if (spins >= max) {
    alert("ðŸ˜¿ 3 spins completed. No win.\nClick Â«RepeatÂ» to try again.");
    return;
  }
  spinBtn.disabled = true;
  spins++;
  spinsText.textContent = spins;
  clearlights();
  let willWin = !won && Math.random() < 0.2;
  let rrImages = [randomImg(3), randomImg(3), randomImg(3)];
  if (willWin) {
    const winImage = img[Math.floor(Math.random() * img.length)];
    const oror = Math.random() < 0.5;
    if (oror) {
      const winRow = Math.floor(Math.random() * 3);
      rrImages[0][winRow] = winImage;
      rrImages[1][winRow] = winImage;
      rrImages[2][winRow] = winImage;
    } else {
      const winCol = Math.floor(Math.random() * 3);
      for (let row = 0; row < 3; row++) {
        rrImages[winCol][row] = winImage;
      }
    }
  }
    animation(0, rrImages[0]);
    animation(1, rrImages[1]);
    animation(2, rrImages[2]);
    setTimeout(() => {
      const win = checkWin(rrImages);
      if (win && !won) {
        won = true;
        winSpin = spins;
        light(win.cells);
        showHearts();
      }
      spinBtn.disabled = false;
    }, 1500);
  }
function resetGame() {
  spins = 0;
  won = false;
  winSpin = null;
  spinsText.textContent = 0;
  confetti.innerHTML = "";
  clearlights();
  for (let i = 0; i < 3; i++) update(i, randomImg(3));
  spinBtn.disabled = false;
}
spinBtn.addEventListener("click", spinAll);
repeatBtn.addEventListener("click", resetGame);
</script>
</body>
</html>